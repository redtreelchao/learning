/**
 * plugin.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */

/*global tinymce:true */

tinymce.PluginManager.add('image2', function(editor) {

    var browser_url = editor.settings.browser_url;

    var createImageList = function(){
        var popup = $("#media-popup");
        popup.modal();
        popup.find(".modal-content").load(browser_url, function(){
            editor.settings.browser_loaded(popup, editor);
        });
    }

	editor.addButton('image', {
		icon: 'image',
		tooltip: 'Insert/edit image',
		onclick: createImageList,
		stateSelector: 'img:not([data-mce-object],[data-mce-placeholder])'
	});

	editor.addMenuItem('image', {
		icon: 'image',
		text: 'Insert image',
		onclick: createImageList,
		context: 'insert',
		prependToContext: true
	});
});
